<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Zen Dragon Trainer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ××¤×œ×™×§×¦×™×” × ×˜×¢× ×ª ×-game.js -->
  <div id="app"></div>

  <!-- ğŸ“– Instructions Modal -->
  <div id="instructionsModal" class="modal hidden">
    <div class="modal-box">
      <div class="modal-head">
        <button id="closeInstructions" class="btn">âœ–</button>
        <button id="langToggle" class="btn">×¢×‘×¨×™×ª</button>
      </div>
      <div id="instructionsContent" class="modal-body"></div>
    </div>
  </div>

  <!-- ğŸ¯ Targets (Goals) Modal -->
  <div id="targetsModal" class="modal hidden">
    <div class="modal-box" style="max-width:560px">
      <div class="modal-head">
        <h3 style="margin:0">ğŸ¯ Set Goals</h3>
        <button id="tgClose" class="btn">âœ–</button>
      </div>
      <div class="modal-body">
        <div class="targets-grid">
          <label>Accuracy â‰¥ <input id="tgAcc" type="number" min="50" max="100" step="1"> %</label>
          <label>Avg. time â‰¤ <input id="tgAvg" type="number" min="300" max="5000" step="10"> ms</label>
          <label>Mistakes â‰¤ <input id="tgMist" type="number" min="0" max="20" step="1"></label>
        </div>
        <div class="targets-actions">
          <button id="tgReset" class="btn">Reset Defaults</button>
          <button id="tgSave" class="btn">Save</button>
        </div>
        <div class="targets-hint">
          These goals update the HUD targets and your personal benchmarks (no auto-unlock).
        </div>
      </div>
    </div>
  </div>

  <script>
  /* ===== Instructions content (HE/EN) ===== */
  const INS_HE = `
  <div dir="rtl" style="text-align:right">
  <h2>×”×•×¨××•×ª ×©×™××•×©</h2>

  <h3>××” ×”××˜×¨×”?</h3>
  ××™××•×Ÿ ×××•×§×“ ×œ×¤×™×ª×•×— ××”×™×¨×•×ª, ×“×™×•×§ ×•×‘×™×˜×—×•×Ÿ ×‘×—×™×©×•×‘ ×‘×¨××©: ×œ×•×— ×›×¤×œ, ×—×–×§×•×ª, ×©×•×¨×©×™× ×•×©×‘×¨×™×.
  ×”××©×—×§ ×××ª×¨ ××ª ×”×—×•×œ×©×•×ª ×©×œ×š ×‘×–××Ÿ ×××ª ×•×“×•×—×£ ××•×ª×š ×œ×”×©×ª×¤×¨ ×‘×¦×•×¨×” ×—×›××” ×•×”×“×¨×’×ª×™×ª.

  <h3>××¦×‘×™ ××©×—×§</h3>
  <b>âš”ï¸ ××¦×‘ ×§×¨×‘ (Combat)</b><br>
  ×ª×¨×’×•×œ ××©×•×œ×‘ ××›×œ ×”× ×•×©××™×, ×œ×¤×™ ×¨××ª ×§×•×©×™. ×œ××—×¨ ×›×œ ×§×¨×‘ ×ª×•×¤×™×¢ ×˜×‘×œ×ª ×”×™×©×’×™×, × ×™×ª×•×— ×‘×™×¦×•×¢×™×, ×•×”××œ×¦×” ××“×•×™×§×ª ××” ×œ×—×–×§.

  <br><br>
  <b>ğŸ“š ××¦×‘ ×ª×¨×’×•×œ (Practice)</b><br>
  ×‘×—×™×¨×” ×©×œ × ×•×©× ××—×“ ×•×”×¢××§×” ×‘×•. ×˜×¢×•×™×•×ª × ×©××¨×•×ª ×•××•×¤×™×¢×•×ª ××—×“×© ×‘××™××•×Ÿ ×™×™×¢×•×“×™ ×œ× ×˜×¨×•×œ ×—×•×œ×©×•×ª ×œ××•×¨×š ×–××Ÿ.

  <h3>××™×š ××ª×—×™×œ×™×?</h3>
  ×‘×•×—×¨×™× ×¨××” â†’ Start Battle. ×”×–××Ÿ ××ª×—×™×œ ×œ×”×™××“×“ ×¨×§ ××”×¨×’×¢ ×©×œ×•×—×¦×™× ×¢×œ Start.

  <h3>××™×š ×¢×•× ×™×?</h3>
  ××§×©×™ 1â€“4 ××• ×œ×—×™×¦×” ×¢×œ ×”××¤×©×¨×•×ª ×‘××¡×š. ×ª×©×•×‘×” × ×›×•× ×” ×ª× ×’×Ÿ ×¦×œ×™×œ ×§×¦×¨.

  <h3>×§×¨×™×˜×¨×™×•× ×™× ×œ×¢×œ×™×™×ª ×¨××”</h3>
  (×××•×¦×¢ ×©×œ 3 ×”×§×¨×‘×•×ª ×”××—×¨×•× ×™×)<br>
  â€¢ ×“×™×•×§ â‰¥ 95%<br>
  â€¢ ×–××Ÿ ×××•×¦×¢ ×œ×©××œ×” â‰¤ 1.50 ×©× ×™×•×ª<br>
  â€¢ â‰¤ 3 ×˜×¢×•×™×•×ª ×œ×§×¨×‘

  <h3>×”Ö¾HUD (×œ×•×— ×”×ª×§×“××•×ª ×‘×¦×“)</h3>
  ××¦×™×’ × ×ª×•× ×™× ××©×œ×•×©×ª ×”×§×¨×‘×•×ª ×”××—×¨×•× ×™×: ×“×™×•×§ ×××•×¦×¢, ×–××Ÿ ×ª×©×•×‘×” ×××•×¦×¢, ×›××•×ª ×˜×¢×•×™×•×ª, ×•Ö¾Weak Topics â€” × ×•×©××™× ×œ×—×™×–×•×§.

  <h3>××™×š ××–×•×”×•×ª ×—×•×œ×©×•×ª?</h3>
  <b>â± ×–××Ÿ ×ª×’×•×‘×” ××™×˜×™:</b> ×× ×‘×™×•×ª×¨ ×Ö¾50% ××”×©××œ×•×ª ×‘× ×•×©× ××¡×•×™× ×”×™×™×ª ××™×˜×™ ××”×××•×¦×¢ ×©×œ×š â€” ×”× ×•×©× ×™×¡×•××Ÿ ×œ×¢×“×™×¤×•×ª ×ª×¨×’×•×œ (××•×¤×™×¢ ×¨××©×•×Ÿ).<br>
  <b>âœ– ×©×™×¢×•×¨ ×˜×¢×•×™×•×ª ×’×‘×•×”:</b> ×× ×˜×¢×™×ª ×‘Ö¾40% ×•××¢×œ×” ××”×©××œ×•×ª ×‘× ×•×©×. ×”× ×•×©××™× ×”××™×˜×™×™× ××•×¦×’×™× ×§×•×“× (×–××Ÿ ×”×•× ××•×™×‘ ××©××¢×•×ª×™ ×‘×¤×¡×™×›×•××˜×¨×™).

  <h3>××™×š ×¢×•×‘×“×ª ××¢×¨×›×ª ×ª×™×§×•×Ÿ ×˜×¢×•×™×•×ª?</h3>
  ×‘×ª×¨×’×•×œ, ×›×œ ×˜×¢×•×ª × ×©××¨×ª. ×›×“×™ ×œ××—×•×§ ××•×ª×” ×¦×¨×™×š ×œ×¢× ×•×ª ×¢×œ×™×” × ×›×•×Ÿ ×¤×¢××™×™× ×‘×©× ×™ ×¡×©× ×™× × ×¤×¨×“×™× ×©×œ Review (×•×‘×™× ×™×”× ×©× ×™ ××™××•× ×™× ×¨×’×™×œ×™×).
  ×›×š ××™×•×× ×•×ª × ×‘× ×™×ª ×™×¦×™×‘ â€” ×œ× ×‘××§×¨×”.

  <h3>×˜×™×¤ ×—×©×•×‘</h3>
  ××œ ×ª×™×¢×¦×¨ ×¢×œ ×©××œ×”. ×–×¨×•×. ×”××¢×¨×›×ª ×ª×—×–×™×¨ ××•×ª×š ×‘×“×™×•×§ ×œ××” ×©×“×•×¨×© ×—×™×–×•×§ â€” ××ª×” ××ª×××Ÿ, ×œ× × ×‘×—×Ÿ.
  </div>
  `;
  const INS_EN = `
  <h2>Instructions</h2>

  <h3>Purpose</h3>
  Boost mental calculation speed, accuracy, and confidence â€” multiplication, powers, roots, and fractions.
  The system tracks weaknesses in real time and adapts training gradually for smart improvement.

  <h3>Game Modes</h3>
  <b>âš”ï¸ Combat</b><br>
  Mixed questions by difficulty. After each battle you get a performance report and precise recommendations.

  <br><br>
  <b>ğŸ“š Practice</b><br>
  Focus on a single topic. Mistakes are saved and resurfaced in structured review sessions to eliminate weaknesses over time.

  <h3>How to start</h3>
  Choose difficulty â†’ Start Battle. Timing begins only after you press Start.

  <h3>How to answer</h3>
  Keys 1â€“4 or click. A short chime plays on correct answers.

  <h3>Ranking up (avg of last 3 battles)</h3>
  â€¢ Accuracy â‰¥ 95%<br>
  â€¢ Avg response â‰¤ 1.50s<br>
  â€¢ â‰¤ 3 mistakes per battle

  <h3>HUD (side panel)</h3>
  Shows averages from your last 3 battles: accuracy, response speed, mistakes, and Weak Topics to target.

  <h3>Weakness detection</h3>
  <b>â± Slow:</b> >50% of a topicâ€™s questions were slower than your battle average (with buffer) â†’ speed priority (listed first).<br>
  <b>âœ– Errors:</b> â‰¥40% wrong in a topic â†’ targeted for accuracy.

  <h3>Mistake Bank</h3>
  In practice mode, mistakes stay saved. To erase one, answer it correctly twice in two separate reviews with normal sessions in between.

  <h3>Pro tip</h3>
  Donâ€™t freeze. Flow. The system will circle back and drill exactly what you need.
  `;

  /* Modal logic */
  let INS_LANG = 'en';
  const insModal = document.getElementById('instructionsModal');
  const insContent = document.getElementById('instructionsContent');
  const insLangBtn = document.getElementById('langToggle');

  function renderInstructions(){
    if (INS_LANG==='en'){ insContent.innerHTML = INS_EN; insLangBtn.textContent='×¢×‘×¨×™×ª'; insContent.removeAttribute('dir'); insContent.style.textAlign='start'; }
    else { insContent.innerHTML = INS_HE; insLangBtn.textContent='English'; insContent.setAttribute('dir','rtl'); insContent.style.textAlign='right'; }
  }
  document.getElementById('closeInstructions').onclick = () => insModal.classList.add('hidden');
  document.getElementById('langToggle').onclick = () => { INS_LANG = (INS_LANG==='en')?'he':'en'; renderInstructions(); };

  // ××©×—×§ ×™×¤×ª×— ××ª ×”××•×“×œ ×¢"×™ ×›×¤×ª×•×¨ ×¢× id="instructionsBtn"
  window.__openInstructions = () => { insModal.classList.remove('hidden'); renderInstructions(); };

  // Goals modal logic (called from game)
  const tgModal = document.getElementById('targetsModal');
  const tgAcc   = document.getElementById('tgAcc');
  const tgAvg   = document.getElementById('tgAvg');
  const tgMist  = document.getElementById('tgMist');

  window.__openTargets = (targets) => {
    tgAcc.value  = targets.acc;
    tgAvg.value  = targets.avgMs;
    tgMist.value = targets.mist;
    tgModal.classList.remove('hidden');
  };
  window.__closeTargets = () => tgModal.classList.add('hidden');
  window.__readTargets = () => ({
    acc:  Math.max(50, Math.min(100, parseInt(tgAcc.value||95))),
    avgMs:Math.max(300, Math.min(5000, parseInt(tgAvg.value||1500))),
    mist: Math.max(0,  Math.min(20,  parseInt(tgMist.value||3)))
  });

  document.getElementById('tgClose').onclick = () => window.__closeTargets();
  document.getElementById('tgSave').onclick  = () => { window.__saveTargetsFromModal && window.__saveTargetsFromModal(); };
  document.getElementById('tgReset').onclick = () => {
    tgAcc.value=95; tgAvg.value=1500; tgMist.value=3;
  };
  </script>

  <script src="game.js"></script>
</body>
</html>







